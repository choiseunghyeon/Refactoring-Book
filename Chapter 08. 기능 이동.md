## 기능 이동

- 함수, 필드 옮기기는 클래스, 모듈 함수 뿐만 아니라 문장 단위에서도 이뤄진다.
- 좋은 소프트웨어 설계의 핵심은 모듈화가 얼마나 잘 되어 있느냐를 뜻하는 모듈성(modularity)이다. 모듈성은 수정하려 할 때 해당 기능과 관련된 일부만 이해해도 가능하게 해주는 능력이다.
- 모듈성을 높이려면 연관된 요소들을 묶고, 요소 사이의 관계를 쉽게 찾고 이해할 수 있도록 해야 한다. 보통은 이해도가 높아질수록 요소를 잘 묶는 방법을 꺠우치게 되는데 이를 반영하려면 요소들을 이리 저리 옮겨야 할 수 있다.

## 명령 - 질의 분리 원칙

- 함수는 성격에 따라 크게 두 가지로 분류할 수 있는데 하나는 어떤 동작을 수행하는 명령(command)이고, 다른 하나는 답을 구하는 질의(query)다.

## 리팩터링

- 함수 옮기기
  - 기능 편애(Feature Envy) 악취가 난다면 수행하자
  - 모듈성
  - 대상 함수가 호출하는 함수들은 무엇인지, 대상 함수를 호출하는 함수들은 무엇인지 그리고 대상 함수가 사용하는 데이터는 무엇인지 살펴본다.
- 필드 옮기기
  - 프로그램의 진짜 힘은 데이터 구조에서 나온다
- 문장을 함수로 옮기기
  - 중복 제거
  - 함수를 호출하는 부분의 앞이나 뒤에서 똑같은 코드가 추가로 실행되면 피호출 함수로 합치자. (나중에 코드의 동작이 변형되어야 하면 다시 함수 밖으로 뽑아내면 된다. 문장을 호출한 곳으로 옮기기 )
  - 피호출 함수와 한 몸은 아니지만 여전히 함께 호출되어야 한다면 해당 문장들과 피호출 함수를 통째로 또 하나의 함수로 추출한다.
- 문장을 호출한 곳으로 옮기기
  - 함수가 일부 호출자에서 다르게 동작하도록 바뀌어야 한다면 달라진 동작을 함수에서 꺼내 해당 호출자로 옮겨야 한다.
- 인라인 코드를 함수 호출로 바꾸기
  - 기존 함수와 같은 일을 할 때 중복을 제거
  - 함수가 없다면 함수 추출하기(6.1절)를 적용하고 함수가 있다면 인라인 코드를 함수 호출로 바꾸기 리팩터링을 적용한다.
- 문장 슬라이드
  - 관련 코드를 모아 이해를 쉽게 한다.
  - 부수효과에 주의
  - 슬라이드할 코드 조각과 건너뛸 코드 중 어느 한쪽이 다른 쪽에서 참조하는 데이터를 수정한다면 슬라이드를 할 수 없다.
- 반복문 쪼개기
  - 반복문에서 일을 한꺼번에 처리하고 있다면 수정할 때 마다 처리되는 일 모두를 잘 이해하고 진행해야 한다. 하지만 각각의 반복문으로 분리해두면 수정할 동작 하나만 이해하면 된다.
  - 함수로 추출하면 목적을 잘 표현할 수 있다.
- 반복문을 파이프라인으로 바꾸기
- 죽은 코드 제거하기
